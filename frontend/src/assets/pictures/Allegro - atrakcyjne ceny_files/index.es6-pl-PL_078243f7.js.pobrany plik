((e,t)=>{for(var i in t)e[i]=t[i]})(window,(e=>{var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=(e,t,s)=>{i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=(e,t)=>{if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,(t=>e[t]).bind(null,o));return s},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,"a",t),t},i.o=(e,t)=>({}.hasOwnProperty.call(e,t)),i.p="https://assets.allegrostatic.com/opbox-modal/",i(i.s=0)})({"+GN7"(e,t){e.exports="0d3"},0(e,t,i){e.exports=i("O14P")},O14P(e,t,i){i.r(t);var s=i("+GN7"),o=i.n(s);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const h=()=>{};window.opbox.component.register([{prototypeName:"allegro.modal",clientImplementationVersion:o.a},{prototypeName:"allegro.modal.withDelay",clientImplementationVersion:o.a}],class{constructor({baseNode:e,props:t,targetWindow:i=window,services:s}){a(this,"showModalByAPI",(e=h)=>{this.visible||(this.onDismiss=e,this.showModal(),this.window.opbox.analytics.sendBoxInteractionEvent({contextNode:this.modalNode,label:"modalAPI",value:"open"}))}),a(this,"hideModalByAPI",()=>{this.visible&&(this.delegateHideModal(),this.window.opbox.analytics.sendBoxInteractionEvent({contextNode:this.modalNode,label:"modalAPI",value:"close"}))}),a(this,"handleHashChange",()=>{if(this.visible&&!this.doesHashMatch(this.triggerHash))return this.hideModal(),void this.handleHashChangeAnalytics(this.actionTypeValue.close);!this.visible&&this.doesHashMatch(this.triggerHash)&&(this.showModal(),this.handleHashChangeAnalytics(this.actionTypeValue.open))}),a(this,"onKeyDown",e=>{27===e.keyCode&&this.visible&&(e.preventDefault(),this.window.opbox.analytics.sendBoxInteractionEvent({contextNode:this.baseNode,label:"modalClose_escKey"}),this.delegateHideModal())}),a(this,"delegateHideModal",()=>{this.doesHashMatch(this.triggerHash)?this.simulateModalAsPage?this.pushBrowserHistory():this.replaceBrowserHistory():this.hideModal()}),a(this,"toggleVisibility",e=>{e.target===this.overlayNode&&this.window.opbox.analytics.sendBoxInteractionEvent({contextNode:this.overlayNode,label:"modalClose_overlay"}),this.visible?this.delegateHideModal():this.showModal()}),this.window=i,this.bodyNode=this.window.document.body,this.onDismiss=h,this.baseNode=e,this.modalTriggers=this.baseNode.querySelectorAll('[data-role="modal-trigger"]'),this.modalNode=this.baseNode.querySelector('[data-role="modal"]'),this.contentNode=this.baseNode.querySelector('[data-role="modal-content-container"]'),this.overlayNode=this.baseNode.querySelector("[data-modal-overlay]"),this.scrollContainer=this.baseNode.querySelector('[data-role="modal-body"]'),this.simulateModalAsPage=t.simulateModalAsPage,this.showOnlyOnceADay=t.showOnlyOnceADay,this.boxName=t.boxName,this.hashMatchStrategy=t.hashMatchStrategy,this.triggerHash=t.triggerLinkUrl,this.showInitially=t.showInitially,this.visibilityPreference=t.visibilityPreference,this.showDelay=t.showDelay,this.visible=!1,this.services=s,this.actionTypeValue={open:"open",close:"close"},this.visibilityClassNameList=t.disableAnimation?["mpof_ki"]:["mpof_ki","_6a774_LwUhs"],this.isModalInitiallyOpenWithHash=!1}getLocationHash(){return this.window.location.hash}getPreviousHash(){const{state:e}=this.window.history;return e instanceof Object&&e.previousHash||""}doesHashMatch(e){switch(this.hashMatchStrategy){case"startsWith":return this.getLocationHash().startsWith(e);case"exact":default:return this.getLocationHash()===e}}reportVisibility(){if(this.visibilityPreference){const{key:e,value:t}=this.visibilityPreference;this.window.opbox.preferences.set(e,t)}}showModal(){this.visible=!0,this.modalNode.classList.remove("mpof_5r"),this.modalNode.classList.add(...this.visibilityClassNameList),this.bodyNode.classList.add("meqh_en"),this.window.opbox.boxViewsMarker.recursivelyMarkBoxAsVisible(this.contentNode),this.reportVisibility()}hideModal(){this.visible=!1,this.isModalInitiallyOpenWithHash=!1,this.modalNode.classList.add("mpof_5r"),this.modalNode.classList.remove(...this.visibilityClassNameList),this.bodyNode.classList.remove("meqh_en"),this.onDismiss(),this.onDismiss=h,this.window.opbox.boxViewsMarker.recursivelyMarkBoxAsHidden(this.contentNode),this.services.get("opbox-modal-service").then(e=>e.broadcastDismiss(this.boxName))}handleHashChangeAnalytics(e){this.window.opbox.analytics.sendBoxInteractionEvent({contextNode:this.overlayNode,label:e===this.actionTypeValue.open?"modalOpen":"modalClose",value:"hashChange"})}dispatchHashChangeEvent(){if(this.window.HashChangeEvent)return void this.window.dispatchEvent(new this.window.HashChangeEvent("hashchange"));const e=this.window.document.createEvent("Event");e.initEvent("hashchange",!0,!0),this.window.dispatchEvent(e)}replaceBrowserHistory(){const{pathname:e,search:t}=this.window.location;this.window.history.replaceState(null,this.window.document.title,`${e}${t}`),this.isModalInitiallyOpenWithHash||this.window.history.back(),this.dispatchHashChangeEvent()}pushBrowserHistory(){const{pathname:e,search:t,hash:i}=this.window.location;this.window.history.pushState({previousHash:i},this.window.document.title,`${e}${t}${this.getPreviousHash()}`),this.dispatchHashChangeEvent()}attachListeners(){this.modalTriggers.forEach(e=>e.addEventListener("click",this.toggleVisibility)),this.window.addEventListener("keydown",this.onKeyDown),this.window.addEventListener("hashchange",this.handleHashChange)}setLastSeenDate(e){this.window.localStorage.setItem(this.boxName,e)}getLastSeenDate(){return this.window.localStorage.getItem(this.boxName)}showModalInitially(){if(this.doesHashMatch(this.triggerHash)||this.showInitially){if(this.showOnlyOnceADay){const e=(()=>{const e=new Date;return`${e.getDate()}${e.getMonth()}${e.getYear()}`})();if(this.getLastSeenDate()===e)return;this.setLastSeenDate(e)}if(this.showDelay){const e=1e3*this.showDelay;return void setTimeout(()=>{this.displayModal()},e)}this.displayModal()}}displayModal(){this.showModal(),this.isModalInitiallyOpenWithHash=!0}onMount(){this.attachListeners(),this.window.opbox.boxViewsMarker.trackBoxScroll(this.scrollContainer),this.services.get("opbox-modal-service").then(e=>e.register({boxName:this.boxName,showModal:this.showModalByAPI,hideModal:this.hideModalByAPI})),this.showModalInitially()}onUnmount(){this.modalTriggers.forEach(e=>e.removeEventListener("click",this.toggleVisibility)),this.window.removeEventListener("keydown",this.onKeyDown),this.window.removeEventListener("hashchange",this.handleHashChange)}})}}));
//# sourceMappingURL=index.es6-pl-PL_078243f7.js.map