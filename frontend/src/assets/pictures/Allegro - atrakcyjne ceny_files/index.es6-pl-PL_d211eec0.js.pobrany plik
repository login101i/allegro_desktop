((e,t)=>{for(var r in t)e[r]=t[r]})(window,(e=>{var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=(e,t,s)=>{r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=(e,t)=>{if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,(t=>e[t]).bind(null,i));return s},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,"a",t),t},r.o=(e,t)=>({}.hasOwnProperty.call(e,t)),r.p="https://assets.allegrostatic.com/sc-14307/",r(r.s=0)})({0(e,t,r){e.exports=r("WdQY")},WdQY(e,t,r){function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t);const i={"pl-PL":{"Przedmiot trafił do koszyka.":[["",["Przedmiot trafił do koszyka."]]],"Nie udało się dodać przedmiotu do koszyka. Spróbuj jeszcze raz.":[["",["Nie udało się dodać przedmiotu do koszyka. Spróbuj jeszcze raz."]]],zamknij:[["",["zamknij"]]]}},n=/({{[^}]+}}|{%[^%}]+%})/g,a=/({{[^}]+}})/g,o=/({%[^%}]+%})/g,d=/({{\s*|\s*}}|{%\s*|\s*%})/g;function m(e,t=""){if("string"==typeof e)throw Error("Translation has to be an array");return e.find(e=>e[0]===t)[1]}const l=(e,t,r)=>{const s=i["pl-PL"][e];if(!s)throw Error(`Missing translation for lang "pl-PL" and key "${e}"`);return t?((e,t,r)=>{let s=m(e,t.context);return parseInt(t.count,10)>=0?s=((e,t)=>{const r=1==(s=t)?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2;var s;return"boolean"!=typeof r?e[r]:e[r?1:0]})(s,t.count):[s]=s,((e,t,r)=>{if(r){let r=0;return e.split(n).map(s=>{if(s.match(o)){const i=t.formatters[r];if(i)return r+=1,i(s.replace(d,""));throw Error(`Missing translation formatter for "${e}"`)}return s.match(a)?t[s.replace(d,"")]:s})}const s=e.match(n);let i=0;return s?s.reduce((r,s)=>{const n=s.replace(d,"");if(s.match(o)){const a=t.formatters[i];if(a)return i+=1,r.replace(s,a(n));throw Error(`Missing translation formatter for "${e}"`)}return s.match(a)?r.replace(s,t[n]):r},e):e})(s,t,r)})(s,t,r):m(s)[0]};var c=r("z/3O"),h=r("dP7j"),u="mjyo_6x msbw_2 mldj_2 mtag_2 mm2b_2 mx7m_1 mdwl_co mlkp_ag mjb5_w6 mg1ced mg80z5 mp7g_oh m7er_k4";class _{constructor(e=window){s(this,"rootNode",null),s(this,"closeButtonNode",null),s(this,"isCurrentMessageOfTypeDanger",!1),s(this,"messageVisibilityTimeout",0),s(this,"render",(e,t,r=3e3)=>{const{body:s}=this.targetWindow.document;if(!this.rootNode||t!==this.isCurrentMessageOfTypeDanger){const r=((e,t=!1)=>{const r=[u,t?"mh36_4 mdwl_5r msts_1p":"mh36_4 mdwl_5r msts_t2"].join(" "),s=t?h.b:h.a;return`\n    <div\n      data-role="message-wrapper"\n      class="mpof_5r mp7g_oz mqm6_0 mj7u_0 m7er_k4 munh_24_s _d9395_3Irk-"\n    >\n      <div\n        class="${r}"\n        data-role="message"\n      >\n        <button\n          type="button"\n          class="mgn2_14 mp0t_0a m9qz_yp mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r msts_n7 mg9e_0 mj7a_0 mjir_sv m2ha_2 m8qd_qh mjt1_n2 b1la9 mgmw_vz mrmn_qo mrhf_u8 m31c_kb m0ux_fp bgkgt m0t1_f9 mvrt_0 mh36_0"\n          data-role="message-close-button"\n          aria-label="${l("zamknij")}"\n        >\n          <img\n            class="mjyo_6x mse2_40 meqh_en msa3_z4 m0s5_e6 mg9e_4 mvrt_4 mj7a_4 mh36_4 mhd5_0m ib0i1"\n            src="${c.a}"\n            alt=""\n            width="40"\n            height="40"\n          >\n        </button>\n        <div class="mg9e_16 mg9e_24_l mvrt_16 mvrt_24_l mj7a_16 mj7a_24_l msts_pt mx7m_1 mlkp_ag m911_co mnyp_co mefy_co mldj_2 mm2b_2 mg11dp">\n          <div class="mjyo_lo mpof_5r mpof_z0_s m0t1_7i mg9e_0 mj7a_0 mh36_0 mvrt_16 mvrt_24_l">\n            <img\n              class="mjyo_6x meqh_en msa3_z4 m0s5_e6 mhd5_0m ib0i1 mse2_56 mg9e_0 mvrt_0 mj7a_0 mh36_0"\n              data-role="message-information-icon"\n              src="${s}"\n              width="32"\n              height="32"\n              aria-hidden="true"\n              alt=""\n            >\n          </div>\n          <div class="mg8j5j">\n            <p\n              class="mgn2_14 mp0t_0a mqu1_21 mgmw_wo mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0"\n              data-role="message-paragraph"\n            >${e}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  `})(e,t),i=this.targetWindow.document.createElement("div");i.innerHTML=r;const n=i.firstElementChild;this.rootNode?(this.detachEventListeners(),s.replaceChild(n,this.rootNode),this.rootNode=n):this.rootNode=s.appendChild(n),this.closeButtonNode=this.rootNode.querySelector('button[data-role="message-close-button"]'),this.isCurrentMessageOfTypeDanger=t,this.attachEventListeners()}this.renderVisibleWithTimeout(r)}),s(this,"onClick",()=>{this.renderHidden()}),this.targetWindow=e}renderSuccess(e){this.render(l("Przedmiot trafił do koszyka."),!1,e)}renderDanger(e){this.render(l("Nie udało się dodać przedmiotu do koszyka. Spróbuj jeszcze raz."),!0,e)}renderVisible(){this.targetWindow.clearTimeout(this.messageVisibilityTimeout),this.rootNode&&this.rootNode.classList.remove("mpof_5r")}renderHidden(){this.targetWindow.clearTimeout(this.messageVisibilityTimeout),this.rootNode&&this.rootNode.classList.add("mpof_5r")}renderVisibleWithTimeout(e){this.renderVisible(),this.messageVisibilityTimeout=this.targetWindow.setTimeout(()=>this.renderHidden(),e)}attachEventListeners(){this.closeButtonNode&&this.closeButtonNode.addEventListener("click",this.onClick)}detachEventListeners(){this.closeButtonNode&&this.closeButtonNode.removeEventListener("click",this.onClick)}}const p=Error("Failed to render precart layer"),g={showPrecartLayer:!1};class f{constructor({window:e,cartClient:t,props:r}){s(this,"changeItems",(e,t,r)=>this.cartClient.changeQuantity(e).then(()=>{const s=e.reduce((e,{delta:t})=>e+t,0);return this.triggerQuantityChangeListeners(s),t.showPrecartLayer?this.window.opbox.page.render.fragment({pathname:this.props.precartLayerUrl,additionalQueryParameters:r}).catch(()=>{this.window.opbox.reportError(p)}):(s>0&&t.showStatusMessage&&this.message.renderSuccess(),Promise.resolve())}).catch(e=>{throw t.showStatusMessage&&this.message.renderDanger(),this.window.opbox.reportError(e),e})),s(this,"add",(e,t=g)=>{var r;const s=e.filter(({delta:e})=>e>0);return this.changeItems(e,t,{precartOfferId:s.map(({itemId:e})=>e),precartSellerId:null===(r=s[0])||void 0===r?void 0:r.sellerId,itemQuantity:s.map(({itemId:e,delta:t})=>`${e}:${t}`)})}),s(this,"addOffer",(e,t=g)=>this.addOffers([e],t)),s(this,"addOffers",(e,t=g)=>this.changeItems(e.map(({itemId:e,quantity:t,sellerId:r,category:s})=>({itemId:e,delta:t,sellerId:r,navCategoryId:null==s?void 0:s.id,navTree:null==s?void 0:s.tree})),t,{precartOfferId:e.map(({itemId:e})=>e),precartSellerId:e[0].sellerId,itemQuantity:e.map(({itemId:e,quantity:t})=>`${e}:${t}`)})),s(this,"removeOffer",({itemId:e,quantity:t,sellerId:r,allowDelete:s})=>this.changeItems([Object.assign({itemId:e,delta:-1*t,sellerId:r},!0===s&&{allowDelete:s})],g,void 0)),s(this,"addBundle",(e,t=g)=>this.changeItems([{itemId:e.bundleMainItemId,delta:e.quantity,sellerId:e.sellerId,rebateId:e.rebateId}],t,{precartOfferId:e.itemsIds,precartSellerId:e.sellerId,rebateId:e.rebateId,quantity:e.quantity.toString(10)})),s(this,"triggerQuantityChangeListeners",e=>{this.quantityChangeListeners.forEach(t=>t(e))}),s(this,"registerQuantityChangeListener",e=>{this.quantityChangeListeners.push(e)}),s(this,"unregisterQuantityChangeListener",e=>{this.quantityChangeListeners=this.quantityChangeListeners.filter(t=>t!==e)}),this.window=e,this.cartClient=t,this.quantityChangeListeners=[],this.props=r,this.message=new _(e)}getPublicApi(){return{add:this.add,addBundle:this.addBundle,addOffer:this.addOffer,addOffers:this.addOffers,removeOffer:this.removeOffer,registerQuantityChangeListener:this.registerQuantityChangeListener,unregisterQuantityChangeListener:this.unregisterQuantityChangeListener}}}let y;(e=>{e.CART_CAPACITY_EXCEEDED="OFFER_CART_CAPACITY_EXCEEDED"})(y||(y={}));class b extends Error{constructor(e,t){super("Failed to add to cart"),this.response=t,this.status=e}}var v={changeQuantity(e){return window.opbox.edge.post("/carts/changeQuantityCommand",{items:e},{headers:{Accept:"application/vnd.allegro.public.v5+json","Content-Type":"application/vnd.allegro.public.v5+json"},withCredentials:!0}).catch(({status:e,data:t})=>{var r;throw 422===e&&null!=t&&null!==(r=t.errors)&&void 0!==r&&r.find(e=>e.code===y.CART_CAPACITY_EXCEEDED)&&window.location.assign("/koszyk?error=CART_CAPACITY_EXCEEDED"),new b(e,t)})}},w=r("rRL6"),C="data-cart-plugin-"+r.n(w).a;try{var I;const e=null===(I=window.document.querySelector(`script[${C}]`))||void 0===I?void 0:I.textContent;if(e){const{cartConfiguration:t}=JSON.parse(e);window.opbox.plugin.register({name:"cart"},new f({window,cartClient:v,props:t}).getPublicApi())}}catch(j){window.opbox.reportError(Error(`Missing "${C}" initial state script`))}},dP7j(e){e.exports=JSON.parse('{"a":"https://assets.allegrostatic.com/metrum/icon/round-tick-f943345bd3.svg","b":"https://assets.allegrostatic.com/metrum/icon/stop-sign-92284fffce.svg"}')},rRL6(e,t){e.exports="79b"},"z/3O"(e){e.exports=JSON.parse('{"a":"https://assets.allegrostatic.com/metrum/icon/x-1a6f095eb2.svg"}')}}));
//# sourceMappingURL=index.es6-pl-PL_d211eec0.js.map